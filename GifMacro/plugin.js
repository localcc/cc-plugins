(function(u,I,i,j,P){"use strict";function g(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}function b(t){if(t&&t.__esModule)return t;var n=Object.create(null);return t&&Object.keys(t).forEach(function(e){if(e!=="default"){var r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,r.get?r:{enumerable:!0,get:function(){return t[e]}})}}),n.default=t,Object.freeze(n)}var o=b(I),f=g(j),l=g(P);class E{url;tags;shorthand;constructor(n,e,r){this.url=n,this.tags=e,this.shorthand=r}fake(){return{animated:!0,available:!0,id:"0",managed:"false",name:`${this.shorthand??"unnamed"}${this.tags[0]!=""?" ["+this.tags.join(", ")+"]":""}`,require_colons:!0,roles:[],url:this.url,allNamesString:`${this.shorthand??"unnamed"}${this.tags[0]!=""?" ["+this.tags.join(", ")+"]":""}`,guildId:"0",faked:!0,tags:this.tags}}}const v=i.findByDisplayName("ConfirmModal"),S=i.findByProps("button","colorRed"),p=i.findByDisplayName("TextInput"),B=i.findByDisplayName("Embed"),{renderImageComponent:M,renderMaskedLinkComponent:k}=i.findByProps("renderImageComponent");function x(t){l.default.persist.ghost.gifs==null&&(l.default.persist.store.gifs=[]);let e=l.default.persist.ghost.gifs.find(s=>s.url==t.url);const[r,d]=o.useState(e?.shorthand??""),[m,_]=o.useState(e?.tags?.join(", ")??"");function C(){const s=m?.split(", ")??[],N=new E(t.url,s,r);l.default.persist.store.gifs=[...l.default.persist.ghost.gifs.filter(R=>R.url!=t.url),N],t.modal.onClose()}function c(){t.modal.onClose()}let a={id:"embed_00",url:t.url};return t.url.startsWith("https://tenor.com")?(a.type="gifv",a.provider={name:"Tenor",url:"https://tenor.co"},a.thumbnail={url:"https://cdn.discordapp.com/attachments/824921608560181261/1021158403256627242/d_o_n_k2.png",width:t.width,height:t.height},a.video={url:t.displayUrl,width:t.width,height:t.height}):(a.type="image",a.image={url:t.displayUrl,width:t.width,height:t.height}),o.createElement(v,{header:"Editing GIF",confirmText:"Accept",cancelText:"Cancel",transitionState:t.modal.transitionState,confirmButtonColor:S.colorBrand,onConfirm:C,onClose:c,onCancel:c},o.createElement("div",{style:{display:"grid",justifyContent:"center"}},o.createElement(B,{embed:a,autoPlayGif:!0,renderImageComponent:M,renderLinkComponent:k})),o.createElement("br",null),o.createElement(p,{placeholder:"Shorthand name for this gif",type:"text",value:r,onChange:d}),o.createElement("br",null),o.createElement(p,{placeholder:"Comma separated list of tags, e.g: amongus, moyai, crab",type:"text",value:m,onChange:_}))}const G=i.findByProps("GIFPickerSearchItem"),y=i.find(t=>t?.default?.sentinel==":").default,h=[];function O(){h.push(f.default.after("queryResults",y,T),f.default.instead("onSelect",y,D)),h.push(f.default.after("render",G.GIFPickerSearchItem.prototype,(t,n)=>(n.props.onContextMenu=e=>{e.target.src&&i.findByProps("openModalLazy").openModal(r=>o.createElement(x,{modal:r,url:n.props.children[1].props.url,displayUrl:e.target.src,width:e.target.width*2,height:e.target.height*2}))},n)))}function T(t,n){let[e,r,d,m,_]=t,c=(l.default.persist.ghost.gifs??[]).filter(a=>a.shorthand?.startsWith(d)||a.tags.find(s=>s.includes(d))!=null);for(const a of c)n.results.emojis.find(s=>s.url==a.url)||n.results.emojis.push(a.fake());return n}function D(t,n){let[e]=t,r=e.results.emojis[e.index];if(r?.faked!=null&&r?.faked)e.options.insertText(r.url);else return n(e)}function L(){for(const t of h)t()}return u.onLoad=O,u.onUnload=L,Object.defineProperty(u,"__esModule",{value:!0}),u})({},cumcord.modules.common.React,cumcord.modules.webpack,cumcord.patcher,cumcord.pluginData);
